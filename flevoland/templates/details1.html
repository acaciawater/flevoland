{% extends 'bootbase.html' %}
{% load staticfiles %}
{% load l10n %}
{% block title %}Locatie {{object.name}}{% endblock title %}
{% block navbar %}{% endblock %}
{% block admin_url %}data/project/{{object.id}}{% endblock %}
{% block script %}
  {{ block.super }}
  <script src="{% static 'flevoland/rect-editor.js' %}"></script>
  
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script src="{% static 'flevoland/highcharts-toggle.js' %}"></script>
{% endblock script %}

{% block content %}

<script> 
function setToggles() {
    {% localize off %}
    {% for pks_dict in pks %}
    	RectEditor.setToggle("{{pks_dict.id}}",function() {addData("/data/get/series/{{pks_dict.pk}}")});
    {% endfor %} 
    {% endlocalize %}
}

 function initializeRectangles() {
     var now = new Date();
     most_recent_rectangle_data = {
         "date": now.toISOString().split('T')[0],
         "values": [
             {% localize off %} 
             {%for data_dict in data %} 
             {
                 "id": "{{data_dict.id}}",
                 "date": "{% localize on %}{{data_dict.date}}{% endlocalize %}",
                 "val": {{data_dict.val}},
                 "op": {{data_dict.op}} 
             },
             {% endfor %}
             {% endlocalize %}
         ]
     };
     RectEditor.initialize("includedSVG", "rect5178-7-1-8-9-9", "rect1308-8-4", most_recent_rectangle_data);
 }
 
 function onSVGLoad() {
     initializeRectangles();
     setToggles();
     loadPrecipitation('/data/get/series/{{neerslag.pk}}');
 }
</script>

<div class = "container">
  <h2>{{projectlocatie.name}}</h2>
  
  <embed id="includedSVG" src="{% static 'flevoland/svg/Figuur0_website_peilbuizen_dynamisch3.svg' %}" width="100%" type="image/svg+xml" onload="onSVGLoad();"/>
  <div id="chart-container" style="width:100%;"></div>

</div>

{% endblock content %}